def categorize_alert(row):
    delta = row['deviation'] - row['final_threshold']
    if row['deviation'] <= row['final_threshold']:
        return 'âœ… No Alert'
    elif 0 < delta <= 0.05:
        return 'âš ï¸ Minor'
    elif 0.05 < delta <= 0.3:
        return 'â— Moderate'
    else:
        return 'ðŸ”´ Major'

df['alert_category'] = df.apply(categorize_alert, axis=1)
